{
  "comment": "Dual Timeframe Configuration Example - Bar Magnifier режим как в PineScript",

  "symbol": "BTC/USDT",
  "timeframe": "15m",
  "execution_timeframe": "1m",
  "start_balance": 10000,
  "leverage": 1,
  "order_type": "long",

  "comment_dual_timeframe": "execution_timeframe (1m) - для точного исполнения TP/SL через high/low. timeframe (15m) - для расчета индикаторов и сигналов входа",

  "calc_on_order_fills": true,
  "max_entries_per_bar": 1,

  "comment_calc_on_order_fills": "calc_on_order_fills=true позволяет входить повторно после закрытия позиции на той же strategy свече (как в PineScript). max_entries_per_bar ограничивает количество входов",

  "data_source": {
    "type": "api",
    "api": {
      "exchange": "binance",
      "symbol": "BTC/USDT",
      "market_type": "spot",
      "auto_save": false
    }
  },

  "comment_data_source": "В dual режиме загружаются execution_timeframe данные, затем ресемплируются в timeframe",

  "entry_conditions": {
    "type": "indicator",
    "comment": "Сигналы проверяются ТОЛЬКО при новой strategy свече (15m)"
  },

  "first_order": {
    "amount_percent": 10,
    "comment": "10% от баланса на первый ордер"
  },

  "dca": {
    "enabled": true,
    "max_orders": 5,
    "step_price": {
      "type": "fixed_percent",
      "value": 2.0,
      "comment": "DCA проверяется на КАЖДОЙ execution свече (1m) для быстрой реакции"
    },
    "martingale": {
      "enabled": true,
      "multiplier": 1.5,
      "progression": "exponential",
      "comment": "exponential: 1x, 1.5x, 2.25x, 3.375x..."
    }
  },

  "take_profit": {
    "enabled": true,
    "percent": 3.0,
    "trailing": {
      "enabled": false,
      "activation_percent": 3.0,
      "trail_percent": 1.0
    },
    "comment": "TP/SL проверяются на КАЖДОЙ execution свече (1m) через high/low для точности"
  },

  "stop_loss": {
    "enabled": true,
    "percent": 10.0,
    "trailing": {
      "enabled": false,
      "activation_percent": 2.0,
      "trail_percent": 0.5
    }
  },

  "risk_management": {
    "max_drawdown_percent": 20,
    "max_open_positions": 1
  },

  "indicators": {
    "enabled": true,
    "comment": "Индикаторы рассчитываются на strategy timeframe (15m)",

    "selected_indicators": {
      "rsi": {
        "enabled": true,
        "period": 14
      },
      "ema": {
        "enabled": true,
        "fast_period": 9,
        "slow_period": 21
      }
    },

    "conditions": [
      {
        "indicator": "rsi",
        "operator": "less_than",
        "value": 30,
        "comment": "RSI < 30 на 15m свече для LONG входа"
      },
      {
        "indicator": "ema_cross",
        "operator": "bullish",
        "comment": "EMA9 > EMA21 на 15m свече"
      }
    ]
  },

  "start_date": "2024-01-01",
  "end_date": "2024-12-31",

  "_documentation": {
    "dual_timeframe_workflow": {
      "1": "Загружаются данные execution_timeframe (1m)",
      "2": "Ресемплируются в timeframe (15m)",
      "3": "На КАЖДОМ 1m тике:",
      "3a": "  - Находится последняя ЗАКРЫТАЯ 15m свеча",
      "3b": "  - Если новая 15m свеча закрылась → проверяются сигналы входа",
      "3c": "  - Проверяются DCA условия (цена может упасть между 15m свечами)",
      "3d": "  - Проверяются TP/SL через high/low текущей 1m свечи",
      "3e": "  - Если calc_on_order_fills=true и позиция закрылась → можно войти снова"
    },
    "look_ahead_bias_protection": {
      "description": "get_parent_candle_index() использует ТОЛЬКО закрытые 15m свечи",
      "example": "Execution тик 10:05 → использует 15m свечу 09:45 (не 10:00, т.к. она закроется только в 10:15)"
    },
    "advantages": {
      "1": "Сигналы на стратегическом таймфрейме (меньше шума)",
      "2": "Точное исполнение TP/SL на мелком таймфрейме (реальнее)",
      "3": "Быстрая реакция DCA при падении цены",
      "4": "Защита от look-ahead bias",
      "5": "Как Bar Magnifier в TradingView"
    }
  }
}
