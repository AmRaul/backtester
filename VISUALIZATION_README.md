# üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±—ç–∫-—Ç–µ—Å—Ç–∞

## –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ plotly.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏:

1. **–ì—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω—ã –∏ —Å–¥–µ–ª–æ–∫** - —Å–≤–µ—á–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫ —Å –º–µ—Ç–∫–∞–º–∏ –≤—Ö–æ–¥–æ–≤/–≤—ã—Ö–æ–¥–æ–≤
2. **–î–∏–Ω–∞–º–∏–∫–∞ –±–∞–ª–∞–Ω—Å–∞** - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
3. **–ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π PnL** - –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫
4. **–ü—Ä–æ—Å–∞–¥–∫–∞ (Drawdown)** - –≥—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Å–∞–¥–∫–∏ –æ—Ç –ø–∏–∫–∞
5. **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫** - –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö vs —É–±—ã—Ç–æ—á–Ω—ã—Ö
6. **–í—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏** - –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–∏–¥

### –ú–µ—Ç–∫–∏ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ —Ü–µ–Ω—ã:

- ‚Üë **–ó–µ–ª–µ–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏** - –≤—Ö–æ–¥ –≤ –ø–æ–∑–∏—Ü–∏—é (–ø–µ—Ä–≤—ã–π –æ—Ä–¥–µ—Ä)
- ‚Üë **–ñ–µ–ª—Ç—ã–µ –º–∞–ª–µ–Ω—å–∫–∏–µ —Å—Ç—Ä–µ–ª–∫–∏** - DCA –æ—Ä–¥–µ—Ä–∞ —Å –Ω–æ–º–µ—Ä–∞–º–∏ —É—Ä–æ–≤–Ω–µ–π
- ‚Üì **–ó–µ–ª–µ–Ω—ã–µ/–∫—Ä–∞—Å–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∏** - –≤—ã—Ö–æ–¥ –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ (—Ü–≤–µ—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç PnL)
- üîµ **–°–∏–Ω—è—è –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è** - —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞
- üü¢ **–ó–µ–ª–µ–Ω–∞—è –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è** - —É—Ä–æ–≤–µ–Ω—å Take Profit
- üî¥ **–ö—Ä–∞—Å–Ω–∞—è –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ª–∏–Ω–∏—è** - —É—Ä–æ–≤–µ–Ω—å Stop Loss

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä:

```python
from backtester import Backtester

# –ó–∞–ø—É—Å–∫–∞–µ–º –±—ç–∫—Ç–µ—Å—Ç
bt = Backtester(config_path='config.json')
results = bt.run_backtest()

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
fig = bt.visualize_results(
    graph_type='all',          # 'all', 'price', 'balance', 'pnl', 'drawdown', 'distribution'
    show_dca=True,            # –ü–æ–∫–∞–∑–∞—Ç—å DCA –æ—Ä–¥–µ—Ä–∞
    show_levels=True,         # –ü–æ–∫–∞–∑–∞—Ç—å —É—Ä–æ–≤–Ω–∏ TP/SL
    save_html=True,           # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ HTML
    filename='results/my_backtest.html'
)

# –û—Ç–∫—Ä—ã—Ç—å –≥—Ä–∞—Ñ–∏–∫ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
fig.show()
```

### –û—Ç–¥–µ–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏:

```python
# –ì—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω—ã –∏ —Å–¥–µ–ª–æ–∫
fig_price = bt.visualize_results(graph_type='price')

# –ì—Ä–∞—Ñ–∏–∫ –±–∞–ª–∞–Ω—Å–∞
fig_balance = bt.visualize_results(graph_type='balance')

# –ì—Ä–∞—Ñ–∏–∫ PnL
fig_pnl = bt.visualize_results(graph_type='pnl')

# –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Å–∞–¥–∫–∏
fig_drawdown = bt.visualize_results(graph_type='drawdown')

# –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫
fig_distribution = bt.visualize_results(graph_type='distribution')
```

### –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ BacktestVisualizer:

```python
from visualizer import BacktestVisualizer

# –ó–∞–ø—É—Å–∫–∞–µ–º –±—ç–∫—Ç–µ—Å—Ç
bt = Backtester(config_path='config.json')
results = bt.run_backtest()

# –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ
data = bt.execution_data if bt.use_dual_timeframe else bt.data_loader.data

# –°–æ–∑–¥–∞–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä
viz = BacktestVisualizer(results, data)

# –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
stats = viz.get_summary_stats()
print(stats)

# –°–æ–∑–¥–∞–µ–º –≥—Ä–∞—Ñ–∏–∫
fig = viz.plot_price_and_trades(height=1000)
viz.save_html(filename='results/custom_report.html', fig=fig)
```

## üê≥ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Docker

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```bash
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
docker compose build --no-cache

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker compose ps
```

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫—Ç–µ—Å—Ç —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π
docker compose exec backtester-web python example_visualize.py

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
docker compose exec backtester-web ls -lh results/
```

### –î–æ—Å—Ç—É–ø –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º:

–í—Å–µ HTML —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–ø–∫–µ `results/` –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∫–∞–∫ volume:
- –ù–∞ —Ö–æ—Å—Ç–µ: `./results/`
- –í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ: `/app/results/`

–ü—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä–æ–π HTML —Ñ–∞–π–ª –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ –ø–∞–ø–∫–µ `results/` –ø–æ—è–≤—è—Ç—Å—è —Ñ–∞–π–ª—ã:

```
results/
‚îú‚îÄ‚îÄ BTCUSDT_visualization_20251207_133045.html  # –í—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏
‚îú‚îÄ‚îÄ price_and_trades.html                       # –ì—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω—ã
‚îú‚îÄ‚îÄ balance.html                                # –ì—Ä–∞—Ñ–∏–∫ –±–∞–ª–∞–Ω—Å–∞
‚îú‚îÄ‚îÄ pnl.html                                    # –ì—Ä–∞—Ñ–∏–∫ PnL
‚îú‚îÄ‚îÄ drawdown.html                               # –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Å–∞–¥–∫–∏
‚îî‚îÄ‚îÄ distribution.html                           # –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫
```

## üé® –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

–í—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç:
- **–ó—É–º** - –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫–æ–ª–µ—Å–∏–∫–æ–º –º—ã—à–∏ –∏–ª–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –æ–±–ª–∞—Å—Ç–∏
- **–ü–∞–Ω–æ—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
- **Hover** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
- **–õ–µ–≥–µ–Ω–¥–∞** - –∫–ª–∏–∫ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è/–ø–æ–∫–∞–∑–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **–≠–∫—Å–ø–æ—Ä—Ç** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

## üìä API –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä–∞

### –ö–ª–∞—Å—Å BacktestVisualizer:

```python
class BacktestVisualizer:
    def __init__(self, results: dict, data: pd.DataFrame = None):
        """
        Args:
            results: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ Backtester.results
            data: OHLCV –¥–∞–Ω–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        """

    def plot_price_and_trades(
        self,
        show_dca: bool = True,
        show_levels: bool = True,
        height: int = 800
    ) -> go.Figure:
        """–ì—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω—ã —Å –º–µ—Ç–∫–∞–º–∏ —Å–¥–µ–ª–æ–∫"""

    def plot_balance(self, height: int = 400) -> go.Figure:
        """–ì—Ä–∞—Ñ–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞"""

    def plot_pnl(self, height: int = 400) -> go.Figure:
        """–ì—Ä–∞—Ñ–∏–∫ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–≥–æ PnL"""

    def plot_drawdown(self, height: int = 400) -> go.Figure:
        """–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Å–∞–¥–∫–∏"""

    def plot_trade_distribution(self, height: int = 400) -> go.Figure:
        """–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö/—É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫"""

    def plot_all(self, height: int = 1600) -> go.Figure:
        """–í—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏ –≤ –æ–¥–Ω–æ–º –æ–∫–Ω–µ"""

    def save_html(self, filename: str = None, fig: go.Figure = None) -> str:
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –≤ HTML —Ñ–∞–π–ª"""

    def get_summary_stats(self) -> dict:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–æ–¥–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
```

## üõ†Ô∏è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```txt
plotly>=5.14.0
kaleido>=0.2.1
pandas>=1.5.0
numpy>=1.21.0
```

## üìù –ü—Ä–∏–º–µ—Ä—ã

–ü–æ–ª–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–º–æ—Ç—Ä–∏ –≤ —Ñ–∞–π–ª–µ `example_visualize.py`:

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
python example_visualize.py

# –í Docker
docker compose exec backtester-web python example_visualize.py
```

## üí° –°–æ–≤–µ—Ç—ã

1. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ (>10000 —Å–≤–µ—á–µ–π) –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –¥–∞—Ç–∞–º
2. **–ü–∞–º—è—Ç—å**: –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –ø–∞–º—è—Ç–∏, —á–µ–º —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ
3. **–ë—Ä–∞—É–∑–µ—Ä**: –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Chrome –∏–ª–∏ Firefox
4. **–≠–∫—Å–ø–æ—Ä—Ç**: HTML —Ñ–∞–π–ª—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ñ—Ñ–ª–∞–π–Ω

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ì—Ä–∞—Ñ–∏–∫ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:
```python
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
if bt.data_loader.data is None:
    print("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏")

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –µ—Å—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Å–¥–µ–ª–∫–∏
if not bt.strategy.trade_history:
    print("–ù–µ—Ç —Å–¥–µ–ª–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è")
```

### –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ plotly:
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
pip install plotly kaleido

# –í Docker
docker compose exec backtester-web pip install plotly kaleido
```

### –§–∞–π–ª –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:
```bash
# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é results
mkdir -p results

# –í Docker
docker compose exec backtester-web mkdir -p /app/results
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è plotly**: https://plotly.com/python/
- **–ü—Ä–∏–º–µ—Ä—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤**: https://plotly.com/python/candlestick-charts/
- **API Reference**: —Å–º. docstrings –≤ `visualizer.py`

---

**–ê–≤—Ç–æ—Ä**: Backtester Team
**–í–µ—Ä—Å–∏—è**: 1.0.0
**–î–∞—Ç–∞**: 2025-12-07
